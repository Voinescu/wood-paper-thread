language: node_js

node_js:
  - 8.2.1

branches:
  only:
    - master
env:
  global:
    - DOCKER_REPO=wood-paper-thread
    - DOCKER_ACC=ralucavoinescu

build:
  ci:
    - shippable_retry yarn install
    - yarn test

  post_ci:
    - docker build -t $DOCKER_ACC/$DOCKER_REPO:$BRANCH.$BUILD_NUMBER .
    - docker push $DOCKER_ACC/$DOCKER_REPO:$BRANCH.$BUILD_NUMBER

integrations:
  hub:
     - integrationName: wpt-dockerhub
       type: dockerRegistryLogin
     - integrationName: wpt-canister
       type: dockerRegistryLogin
